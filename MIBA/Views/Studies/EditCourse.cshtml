@model CourseAndLectors
@{
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}

<div id="menuToggle">
    <input type="checkbox" />
    <span></span>
    <span></span>
    <span></span>
    <ul id="menu">
        <li>
            <a asp-controller="Home" asp-action="Index" type="submit">Главная</a>
        </li>
        <li>
            <a asp-controller="Admin" asp-action="Index" type="submit">Все таблицы</a>
        </li>
        <li>
            <a asp-controller="Admin" asp-action="Logout" type="submit">Выйти</a>
        </li>
    </ul>
</div>

<form class="edit-form" method="post" asp-action="EditCourse" enctype="multipart/form-data">
    <div class="row pb-2">
        <h2 class="text-primary">Редактирование Курса</h2>
        <hr />
    </div>

    <div class="user-details">
        <div class="input-box" hidden>
            <span asp-validation-for="Studies.CategoryId" class="details">CategoryId</span>
            <input asp-for="Studies.CategoryId" name="CategoryId" placeholder="" required>
        </div>
        <div class="input-box">
            <span asp-validation-for="Studies.Title" class="details">Название курса</span>
            <input asp-for="Studies.Title" name="Title" placeholder="" required>
        </div>
        <div class="input-box">
            <span asp-validation-for="Studies.Description" class="details">Описание</span>
            <input asp-for="Studies.Description" name="Description" placeholder="" required>
        </div>
        <div class="input-box">
            <span asp-validation-for="Studies.StudyFormat" class="details">Формат обучения</span>
            <select class="form-select select-width" asp-for="Studies.StudyFormat">
                <option value="0">Очный</option>
                <option value="1">Заочный</option>
            </select>
        </div>
        <div class="input-box">
            <span asp-validation-for="Studies.StartTime" class="details">Начало обучения</span>
            <input asp-for="Studies.StartTime" name="StartTime" class="select-width" type="date" placeholder="" required>
        </div>
        <div class="input-box">
            <span asp-validation-for="Studies.EndTime" class="details">Конец обучения</span>
            <input asp-for="Studies.EndTime" name="EndTime" class="select-width" type="date" placeholder="" required>
        </div>
        <div class="input-box">
            <span asp-validation-for="Studies.Cost" class="details">Цена</span>
            <input asp-for="Studies.Cost" name="Cost" class="select-width" placeholder="" required>
        </div>
        <div class="input-box">
            <span asp-validation-for="Studies.DocumentAfter" class="details">Выдаваемый документ</span>
            <input asp-for="Studies.DocumentAfter" name="DocumentAfter" placeholder="" required>
        </div>
        <div class="input-box">
            <span asp-validation-for="Studies.InfoToKnow" class="details">Блок "Знать"</span>
            <textarea asp-for="Studies.InfoToKnow" name="InfoToKnow" placeholder="" required></textarea>
        </div>
        <div class="input-box">
            <span asp-validation-for="Studies.InfoToCan" class="details">Блок "Уметь"</span>
            <textarea asp-for="Studies.InfoToCan" name="InfoToCan" placeholder="" required></textarea>
        </div>
        <div class="input-box">
            <span asp-validation-for="Studies.InfoToUse" class="details">Блок "Владеть"</span>
            <textarea asp-for="Studies.InfoToUse" name="InfoToUse" placeholder="" required></textarea>
        </div>
        <div class="input-box">
            <span asp-validation-for="Studies.CourseProgramm" class="details">Программа курса</span>
            <ul id="programs">
                @{
                    string[] arr = Model.Studies.CourseProgramm.Split("<li>");
                    int i = 1000;
                    @foreach (string item in arr)
                    {
                        string row = item.Split("</li>")[0];
                            @if (row != "")
                            {
                                <div class="nav chapter-div" id="@i">
                                    @Html.Raw($"<li class='chapter' id='{i.ToString() + "li"}'>{row.Split(". ")[1]}")
                                    @Html.Raw("</li>")
                                    <div>
                                        <a onclick="addHidden(@i)" style="margin-top: 20px; margin-left: 20px">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="red" class="bi bi-x-circle-fill" viewBox="0 0 16 16">
                                                <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293 5.354 4.646z" />
                                            </svg>
                                        </a>
                                    </div>
                                    @{i++;}
                                </div>
                            }
                    }
                }
            </ul>
            <input id="chapter" placeholder="Раздел" class="chapter-input-width" />
            <a class="btn btn-primary" onclick="addChapter()">Добавить раздел</a>
            <a class="btn btn-danger" onclick="deleteChapter()">Очистить список</a>
            <input id="outer-programs" asp-for="Studies.CourseProgramm" name="CourseProgramm" placeholder="" required hidden>
        </div>
        <div class="input-box">
            <span asp-validation-for="Lectors" class="details">Лекторы</span>
            <ul id="lectors">
                @if (Model.Studies.Lectors != "")
                {
                    @foreach (string id in Model.Studies.Lectors.Split(' '))
                    {
                        <div class="nav lectors-div" id="@id">
                            @{
                                string newId = id.ToString() + "li";
                            }
                            <li class="lector" id="@newId">
                                    @foreach (Lectors lector in Model.Lectors)
                                    {
                                        if (lector.Id == Convert.ToInt32(id))
                                        {
                                            @Html.Raw(lector.FullName)
                                            break;
                                        }
                                    }
                            </li>
                            <a>
                                <a onclick="addHidden(@id)">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="red" class="bi bi-x-circle-fill" viewBox="0 0 16 16">
                                        <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293 5.354 4.646z" />
                                    </svg>
                                </a>
                            </a>
                        </div>
                    }
                }
            </ul>
            <select id="lector" class="form-select lector-select-width">
                @foreach(Lectors lector in Model.Lectors)
                {
                    <option value="@lector.Id">@lector.FullName</option>
                }
            </select>
            <a class="btn btn-primary" onclick="addLector()">Добавить лектора</a>
            <a class="btn btn-danger" onclick="deleteLectors()">Очистить список</a>
            <input id="outer-lectors" asp-for="Lectors" name="Lectors" placeholder="" required hidden>
        </div>
    </div>

    <button type="submit" onclick="addFinalData()" class="btn btn-primary" style="width:200px">Изменить</button>
    <a asp-controller="Studies" asp-action="Index" class="btn btn-secondary" style="width:200px">Вернуться</a>
</form>

@section Scripts{
    @{
        <partial name="_ValidationScriptsPartial" />
    }
    }
